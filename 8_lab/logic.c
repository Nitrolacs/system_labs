/*! Функции для вычислений */

#include <stdio.h>
#include <math.h>

#include "logic.h"

// Функция для решения квадратного уравнения и вывода разложения на множители
void SolveQuadratic(double a, double b, double c)
{
    printf("Коэффициенты квадратного уравнения: a = %.2f, b = %.2f, c = %.2f\n",
           a, b, c); // выводим коэффициенты
    double d = b * b - 4 * a * c; // дискриминант
    if (d < 0)
    {
        printf("Уравнение не имеет действительных корней.\n");
    }
    else if (d == 0)
    {
        double x = -b / (2 * a); // единственный корень
        printf("Уравнение имеет один действительный корень: x = %.2f\n", x);
        printf("Разложение на множители: (%.2f)x + %.2f = 0\n", a, b);
    }
    else
    {
        double x1 = (-b + sqrt(d)) / (2 * a); // первый корень
        double x2 = (-b - sqrt(d)) / (2 * a); // второй корень
        printf("Уравнение имеет два действительных корня: x1 = %.2f, x2 = %.2f\n",
               x1, x2);
        printf("Разложение на множители: "
               "(%.2f)x^2 + (%.2f)x + %.2f = (%.2f)(x - %.2f)(x - %.2f)\n",
               a, b, c, a, x1, x2);
    }
}

// Функция для решения кубического уравнения и вывода разложения на множители
void SolveCubic(double a, double b, double c, double d)
{
    printf("Коэффициенты кубического уравнения: a = %.2f, b = %.2f, "
           "c = %.2f, d = %.2f\n", a, b, c, d);
    // Используем формулу Кардано
    double p = (3 * a * c - b * b) / (3 * a * a); // Первый коэффициент
    double q = (2 * b * b * b - 9 * a * b * c + 27 * a * a * d) /
               (27 * a * a * a); // Второй коэффициент
    double r = q * q / 4 + p * p * p / 27; // Радикал

    if (r > 0)
    {
        // Один действительный корень и два комплексных корня
        double s = sqrt(r); // Квадратный корень из радикала
        double u = cbrt(-q / 2 + s); // Первый кубический корень
        double v = cbrt(-q / 2 - s); // Второй кубический корень
        double x = u + v; // Действительный корень
        printf("Уравнение имеет один действительный корень: x = %.2f\n", x);
        printf("Разложение на множители: (%.2f)x^3 + (%.2f)x^2 + (%.2f)x + %.2f = (%.2f)(x - %.2f)\n",
               a, b, c, d, a, x);
        printf("Два комплексных корня не выводятся.\n");
    }
    else if (r == 0)
    {
        // Три действительных корня, из которых два равны
        double u = cbrt(-q / 2); // Кубический корень
        double x1 = 2 * u; // Первый корень
        double x2 = -u; // Второй и третий корень
        printf("Уравнение имеет три действительных корня: x1 = %.2f, x2 = x3 = %.2f\n",
               x1, x2);
        printf("Разложение на множители: (%.2f)x^3 + (%.2f)x^2 + (%.2f)x + %.2f = (%.2f)(x - %.2f)(x - %.2f)^2\n",
               a, b, c, d, a, x1, x2);
    }
    else
    {
        // Три различных действительных корня
        double phi = acos(-q / 2 * sqrt(-27 / (p * p * p))); // Угол
        double x1 = 2 * sqrt(-p / 3) * cos(phi / 3); // Первый корень
        double x2 =
                2 * sqrt(-p / 3) * cos((phi + 2 * M_PI) / 3); // Второй корень
        double x3 =
                2 * sqrt(-p / 3) * cos((phi + 4 * M_PI) / 3); // Третий корень
        printf("Уравнение имеет три различных действительных корня: x1 = %.2f, x2 = %.2f, x3 = %.2f\n",
               x1, x2, x3);
        printf("Разложение на множители: (%.2f)x^3 + (%.2f)x^2 + (%.2f)x + %.2f = (%.2f)(x - %.2f)(x - %.2f)(x - %.2f)\n",
               a, b, c, d, a, x1, x2, x3);
    }
}

